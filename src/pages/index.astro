---
import Layout from "../layouts/Layout.astro";
import LatestEpisode from "../components/LatestEpisode.astro";
import ButtonLink from "../components/ButtonLink.astro";
import { getEpisodes } from "../utilities/tools";

const response = await fetch("https://anchor.fm/s/1f8af31c/podcast/rss");
const xmlText = await response.text();
let episodes = await getEpisodes(xmlText);
let episodesSlice = episodes.slice(0, 3);

let plateforms = [
  {
    name: "apple",
    link: "https://podcasts.apple.com/us/podcast/young-wifed-up/id1513411183",
    icon: "fab fa-apple",
  },
  {
    name: "spotify",
    link: "https://open.spotify.com/show/0XTyq6aqD5hSFvy7S8Bso6",
    icon: "fab fa-spotify",
  },
  {
    name: "youtube",
    link: "https://www.youtube.com/@youngandwifedup",
    icon: "fab fa-youtube",
  },
];
---

<Layout>
  <section class="index-page">
    <div class="container">
      <!-- Latest Episodes -->
      <h2>Latest Episodes</h2>
      <div class="latest-episodes">
        {episodesSlice.map((episode) => <LatestEpisode episode={episode} />)}
      </div>
      <h2>Connect With Us</h2>
      <div class="info-squares">
        <div class="facebook square">
          <div class="overlay">
            <h3>Join Our Facebook Group</h3>
            <ButtonLink
              backgroundColor="#999999"
              color="white"
              link="https://www.facebook.com/groups/5430616510285530/"
              outside={true}
              center={true}
            >
              Join the Group
            </ButtonLink>
          </div>
        </div>
        <div class="patreon square">
          <div class="overlay">
            <h3>Support us on Patreon</h3>
            <ButtonLink
              backgroundColor="#999999"
              color="white"
              link="https://www.patreon.com/youngandwifedup"
              outside={true}
              center={true}
            >
              Sign Up
            </ButtonLink>
          </div>
        </div>
        <div class="coffee square">
          <div class="overlay">
            <h3>Buy us a Coffee</h3>
            <ButtonLink
              backgroundColor="#999999"
              color="white"
              link="https://www.buymeacoffee.com/youngandwifedup"
              outside={true}
              center={true}
            >
              Buy Coffee
            </ButtonLink>
          </div>
        </div>
      </div>
      <!-- Plateforms List -->
      <div class="plateform-list">
        <h2>Listen On</h2>
        <div class="list-container">
          {
            plateforms.map((item) => (
              <a
                target="_blank"
                href={item.link}
                class={`platform ${item.name}`}
              >
                <i class={item.icon} />
              </a>
            ))
          }
        </div>
      </div>
    </div>
  </section>
</Layout>

<style lang="scss">
  .info-squares {
    width: 85%;
    margin: 2rem auto;
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
    .facebook {
      background-image: url("../images/phone.jpg");
      background-position: center;
      background-fit: cover;
    }
    .patreon {
      background-image: url("../images/patreon.jpg");
      background-position: center;
      background-fit: cover;
    }
    .coffee {
      background-image: url("../images/coffee.jpg");
      background-position: center;
      background-fit: cover;
    }
    .square {
      position: relative;
      width: 300px;
      height: 250px;
      margin: 1rem 0.5rem;
      border-radius: 10px;
      overflow: hidden;
      transition: transform 0.5s ease-in-out;
      &:hover {
        transform: scale(1.05);
      }
      // border: 3px red solid;
      .overlay {
        color: white;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        background: rgb(145, 130, 133);
        background: linear-gradient(
          161deg,
          rgba(145, 130, 133, 0.8576024159663865) 30%,
          rgba(206, 179, 184, 0.8155856092436975) 64%
        );
        flex-direction: column;
        justify-content: space-around;
        text-align: center;
        padding: 1rem;
        line-height: 1.5;
      }
    }
    h3 {
      font-size: 1.25rem;
      margin-bottom: 1rem;
    }
  }
  .latest-episodes {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  .plateform-list {
    .list-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    margin: 2rem 0;
    .spotify {
      color: #c0c8bd;
    }
    .youtube {
      color: #ceb3b8;
    }
    .apple {
      color: #b7c5c6;
    }
  }

  .platform {
    font-size: 6rem;
    margin: 0 2rem;
    transition: transform 0.5s ease;
    &:hover {
      transform: scale(1.02);
    }
  }

  h2 {
    font-size: 2rem;
    margin: 1.5rem 0;
    text-align: center;
    font-weight: 400;
    font-style: italic;
    color: #999999;
  }

  @media (max-width: 768px) {
    .info-squares {
      width: 100%;
      flex-direction: column;
      .square {
        width: 100%;
        height: 300px;
        margin: 1rem 0;
      }
    }
    .platform {
      font-size: 5rem;
      margin: 0 1.15rem;
    }
  }
</style>
